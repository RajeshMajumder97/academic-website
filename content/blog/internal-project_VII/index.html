---
date: "2022-03-16T00:00:00Z"
external_link: ""
image:
#  caption: Photo by rawpixel on Unsplash
  focal_point: Smart
  
#slides: example
summary: How to calculate sample size.
tags:
- Blogs
title: Sample Size Calculation in R.

output:
  blogdown::html_page:
    toc: true
  
---

<script src="{{< blogdown/postref >}}index_files/header-attrs/header-attrs.js"></script>

<div id="TOC">
<ul>
<li><a href="#the-why-of-sample-size-calculations">The Why of Sample Size Calculations :</a></li>
<li><a href="#key-features-of-sample-size-calculation">Key features of Sample Size Calculation :</a></li>
<li><a href="#effect-size">Effect Size :</a></li>
<li><a href="#mathematical-formulas-for-calculating-sample-sazes">Mathematical Formulas for calculating sample Sazes :</a>
<ul>
<li><a href="#a-for-estimation">(A) For Estimation :</a></li>
<li><a href="#b-for-testing">(B) For testing :</a></li>
</ul></li>
<li><a href="#sample-size-calculation-in-r">Sample Size Calculation in R :</a></li>
<li><a href="#one-mean-t-test">One Mean T-test :</a></li>
<li><a href="#two-means-t-test">Two Means T-test :</a></li>
<li><a href="#paired-t-test">Paired T-test :</a></li>
<li><a href="#one-way-anova">One-Way ANOVA :</a></li>
<li><a href="#single-proportion-test">Single Proportion Test :</a></li>
<li><a href="#two-proportions-test">Two Proportions Test :</a></li>
<li><a href="#chi-squared-test">Chi-Squared Test :</a></li>
<li><a href="#simple-multiple-linear-regression">Simple &amp; Multiple Linear Regression :</a></li>
<li><a href="#correlation">Correlation :</a></li>
<li><a href="#non-parametric-t-tests">Non-Parametric T-tests :</a></li>
<li><a href="#kruskal-wallace-test">Kruskal Wallace Test :</a></li>
<li><a href="#repeated-measures-anova">Repeated Measures ANOVA :</a></li>
</ul>
</div>

<div id="the-why-of-sample-size-calculations" class="section level2">
<h2>The Why of Sample Size Calculations :</h2>
<ul>
<li><p>In designing an experiment, a key question is : <strong>How many individuals/subjects do I need for my experiment ?</strong></p></li>
<li><p>Too small of a sample size can under detect the effect of interest in our experiment.</p></li>
<li><p>Too large of a sample size may lead to unnecessary wasting of resources and individuals.</p></li>
<li><p>We want our sample size to be <em>‘just right’</em>.</p></li>
<li><p><em>The answer:</em> <strong>Sample Size Calculation</strong>.</p></li>
<li><p><em>Goal:</em> <strong>We strive to have enough samples to resonably detect if it really is there without wasting limited resources on too many samples.</strong></p></li>
</ul>
</div>
<div id="key-features-of-sample-size-calculation" class="section level2">
<h2>Key features of Sample Size Calculation :</h2>
<ul>
<li><p><strong>Effect Size:</strong> magnitude of the effect under the <span class="math inline">\(H_1\)</span> (<em>alternative</em>). - the larger the effect size, the easier it is to an effect and require fewer samples.</p></li>
<li><p><strong>Power:</strong> Probability of correctly rejecting the <span class="math inline">\(H_0\)</span>(<em>null</em>) if it is flse. i.e., (<span class="math inline">\(1-\beta\)</span>), where <span class="math inline">\(\beta\)</span>= Type-II Error.</p></li>
<li><p><strong>Significance level(<span class="math inline">\(\alpha\)</span>):</strong> Probability of falsely rejecting the null hypothesis even through it is true. i.e., Type-I error.</p></li>
</ul>
</div>
<div id="effect-size" class="section level2">
<h2>Effect Size :</h2>
<ul>
<li><p>While Power and Significance level are usually set irrespective of the data, the effect size is a property of the sample data.</p></li>
<li><p>It is essentially a function of the difference between the means of the null and alternative hypotheses over the variation (standard deviation) in the data.<span class="math display">\[Effect\:Size \approx \frac{{|{\mu}_{H_1}-{\mu}_{H_0}}|}{\sigma}\]</span></p></li>
<li><p>Note that, this sample size can also be calculated from the Confidence interval. But here we are ignoring that technique.</p></li>
</ul>
</div>
<div id="mathematical-formulas-for-calculating-sample-sazes" class="section level2">
<h2>Mathematical Formulas for calculating sample Sazes :</h2>
<div id="a-for-estimation" class="section level3">
<h3>(A) For Estimation :</h3>
<div class="figure">
<img src="Sample%20Size%20estimation%20formula%20for%20Esimation%20point%20of%20view.PNG" alt="" />
<p class="caption">For Estimation</p>
</div>
</div>
<div id="b-for-testing" class="section level3">
<h3>(B) For testing :</h3>
<div class="figure">
<img src="Sample%20Size%20estimation%20formula%20for%20testing%20Proportion.PNG" alt="" />
<p class="caption">For Proportion</p>
</div>
<div class="figure">
<img src="Sample%20Size%20estimation%20formula%20for%20testing%20Mean.PNG" alt="" />
<p class="caption">For Mean</p>
</div>
<div class="figure">
<img src="Sample%20Size%20estimation%20formula%20for%20Epidemiology.PNG" alt="" />
<p class="caption">For Epidemiology Study Design</p>
</div>
<div class="figure">
<img src="Sample%20Size%20estimation%20formula%20for%20Epidemiology_2.PNG" alt="" />
<p class="caption">For Epidemiology Study Design</p>
</div>
</div>
</div>
<div id="sample-size-calculation-in-r" class="section level2">
<h2>Sample Size Calculation in R :</h2>
<table>
<tbody>
<tr class="odd">
<td>Table of R packages &amp; functions for calculating Sample Size for different tests</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th align="left">Name of test</th>
<th align="center">Package</th>
<th align="center">Function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">One Mean T-test</td>
<td align="center">pwr</td>
<td align="center">pwr.t.test()</td>
</tr>
<tr class="even">
<td align="left">Two Means T-test</td>
<td align="center">pwr</td>
<td align="center">pwr.t.test()</td>
</tr>
<tr class="odd">
<td align="left">Two Means T-test (unequal Sample)</td>
<td align="center">pwr</td>
<td align="center">pwr.t2n.test()</td>
</tr>
<tr class="even">
<td align="left">Paired T-test</td>
<td align="center">pwr</td>
<td align="center">pwr.t.test()</td>
</tr>
<tr class="odd">
<td align="left">One-way ANOVA</td>
<td align="center">pwr</td>
<td align="center">pwr.anova.test()</td>
</tr>
<tr class="even">
<td align="left">Single Proportion Test</td>
<td align="center">pwr</td>
<td align="center">pwr.p.test()</td>
</tr>
<tr class="odd">
<td align="left">Two Proportions Test</td>
<td align="center">pwr</td>
<td align="center">pwr.2p.test()</td>
</tr>
<tr class="even">
<td align="left">Two Proportion Test (unequal Sample)</td>
<td align="center">pwr</td>
<td align="center">pwr.2p2n.test()</td>
</tr>
<tr class="odd">
<td align="left">Chi-Squared Test</td>
<td align="center">pwr</td>
<td align="center">pwr.chisq.test()</td>
</tr>
<tr class="even">
<td align="left">Simple Linear Regression</td>
<td align="center">pwr</td>
<td align="center">pwr.f2.test()</td>
</tr>
<tr class="odd">
<td align="left">Multiple Linear Regression</td>
<td align="center">pwr</td>
<td align="center">pwr.f2.test()</td>
</tr>
<tr class="even">
<td align="left">Correlation</td>
<td align="center">pwr</td>
<td align="center">pwr.r.test()</td>
</tr>
<tr class="odd">
<td align="left">One Mean Wilcoxon Test</td>
<td align="center">pwr</td>
<td align="center">pwr.t.test()+15%</td>
</tr>
<tr class="even">
<td align="left">Mann-Whitney Test</td>
<td align="center">pwr</td>
<td align="center">pwr.t.test()+15%</td>
</tr>
<tr class="odd">
<td align="left">Paired Wilcoxon Test</td>
<td align="center">pwr</td>
<td align="center">pwr.t.test()+15%</td>
</tr>
<tr class="even">
<td align="left">Kruskal Wallace Test</td>
<td align="center">pwr</td>
<td align="center">pwr.anova.test()+15%</td>
</tr>
<tr class="odd">
<td align="left">Repeated Measures ANOVA</td>
<td align="center">WebPower</td>
<td align="center">wp.rmanova()</td>
</tr>
<tr class="even">
<td align="left">Multi-way ANOVA (1 Category of interest)</td>
<td align="center">WebPower</td>
<td align="center">wp.kanova()</td>
</tr>
<tr class="odd">
<td align="left">Multi-way ANOVA (&gt;1 Category of interest)</td>
<td align="center">WebPower</td>
<td align="center">wp.kanova()</td>
</tr>
<tr class="even">
<td align="left">Non-Parametric Regression (Logistic)</td>
<td align="center">WebPower</td>
<td align="center">wp.logistic()</td>
</tr>
<tr class="odd">
<td align="left">Non-Parametric Regression (Poisson)</td>
<td align="center">WebPower</td>
<td align="center">wp.poisson</td>
</tr>
<tr class="even">
<td align="left">Multilevel modeling: CRT</td>
<td align="center">WebPower</td>
<td align="center">wp.crt2arm/wp.crt3arm</td>
</tr>
<tr class="odd">
<td align="left">Multilevel modeling: MRT</td>
<td align="center">WebPower</td>
<td align="center">wp.mrt2arm/wp.mrt3arm</td>
</tr>
</tbody>
</table>
</div>
<div id="one-mean-t-test" class="section level2">
<h2>One Mean T-test :</h2>
<ul>
<li><strong>Description:</strong> This tests if a sample mean is any different from a set value for a normally distributed variable.</li>
</ul>
<table>
<thead>
<tr class="header">
<th>Numeric Var(s)</th>
<th>Cat. Var(s)</th>
<th>Cat. Var Group #</th>
<th>Cat. Var # of interest</th>
<th>Parametric</th>
<th>Paired</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>Yes</td>
<td>No</td>
</tr>
</tbody>
</table>
<ul>
<li><p><strong>Effect size calculation:</strong> <span class="math inline">\(Effect\:Size(D)= \frac{{|{\mu}_{H_1}-{\mu}_{H_0}}|}{\sigma}\)</span></p></li>
<li><p><strong><a href="Example:(1)" class="uri">Example:(1)</a></strong> <strong>Is the average body temperature of college students any different from 98.6°F?</strong></p></li>
<li><p><strong>Solution:</strong></p>
<ul>
<li><p>Here, <span class="math inline">\(H_0\:: Avg\:Body\:temp.=98.6°F\)</span> and <span class="math inline">\(H_0\:: Avg\:Body\:temp.\neq 98.6°F\)</span></p></li>
<li><p>We will guess that the <strong>effect sizes will be medium.</strong></p></li>
<li><p>For t-tests: <strong>0.2=small</strong>, <strong>0.5=medium</strong>, and <strong>0.8=large</strong> effect sizes.</p></li>
<li><p><strong>R Package:</strong> <em>pwr</em> Package</p></li>
<li><p><strong>R function:</strong> <em>pwr.t.test(d = , sig.level = , power = , type = c(“two.sample”, “<strong>one.sample</strong>”, “paired”))</em></p>
<ul>
<li>d= effect size</li>
<li>sig.level= significant level</li>
<li>power= power of test</li>
<li>type= type of test</li>
</ul></li>
<li><p><strong>Answer of the problem:</strong></p>
<pre class="r"><code>    library(pwr)
    Pwer_t=pwr.t.test(d=0.5, sig.level=0.05, power=0.80, type=&quot;one.sample&quot;,alternative=&quot;two.sided&quot;)
    Pwer_t</code></pre>
<pre><code>## 
##      One-sample t test power calculation 
## 
##               n = 33.36713
##               d = 0.5
##       sig.level = 0.05
##           power = 0.8
##     alternative = two.sided</code></pre>
<pre class="r"><code>    print(paste0(&quot;Sample Size by rounding off is:&quot;,round(Pwer_t$n,0)))</code></pre>
<pre><code>## [1] &quot;Sample Size by rounding off is:33&quot;</code></pre></li>
</ul></li>
<li><p><strong><a href="Example:(2)" class="uri">Example:(2)</a></strong> <strong>Calculate the sample size for the following scenarios (with <span class="math inline">\(\alpha=0.05\)</span>, and power=0.80):</strong></p>
<ul>
<li><p><strong>(i)</strong> You are interested in determining if the average income of college freshman is less than Rs.20,000. You collect trial data and find that the mean income was Rs.14,500 (SD=6000).</p></li>
<li><p><strong>(ii)</strong> You are interested in determining if the average sleep time change in a year for college freshman is different from zero. You collect the following data of sleep change (in hours).</p>
<table>
<thead>
<tr class="header">
<th align="center">Variable</th>
<th align="center">Values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Sleep Change</td>
<td align="center">-0.55, 0.16, 2.6, 0.65, -0.23, 0.21, -4.3, 2, -1.7, 1.9</td>
</tr>
</tbody>
</table></li>
<li><p><strong>(iii)</strong> You are interested in determining if the average weight change in a year for college freshman is greater than zero.</p></li>
</ul></li>
<li><p><strong>Solution:</strong></p>
<ul>
<li><ol style="list-style-type: lower-roman">
<li>You are interested in determining if the average income of college freshman is less than Rs.20,000. You collect trial data and find that the mean income was Rs.14,500 (SD=6000).</li>
</ol>
<ul>
<li><p>Effect size = <span class="math inline">\((Mean_{H_1}-Mean_{H_0})/SD= (14,500-20,000)/6000 = -0.917\)</span></p></li>
<li><p>One-tailed test</p></li>
<li><p><strong>R Code:</strong></p></li>
</ul>
<pre class="r"><code>  print(paste0(&quot;The Sample Size is :&quot;,round(pwr.t.test(d=-0.917, sig.level=0.05, power=0.80, type=&quot;one.sample&quot;, alternative=&quot;less&quot;)$n,0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is :9&quot;</code></pre></li>
<li><ol start="2" style="list-style-type: lower-roman">
<li>Effect size =<span class="math inline">\((Mean_{H_1}-Mean_{H_0})/SD =(-0.446-0)/1.96 = -0.228\)</span></li>
</ol>
<ul>
<li><p>Two-tailed test</p></li>
<li><p><strong>R Code:</strong></p></li>
</ul>
<pre class="r"><code>print(paste(&quot;The Sample Size is :&quot;,round(pwr.t.test(d=-0.228, sig.level=0.05, power=0.80, type=&quot;one.sample&quot;, alternative=&quot;two.sided&quot;)$n,0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is : 153&quot;</code></pre></li>
<li><ol start="3" style="list-style-type: lower-roman">
<li><em>Try it by yourself.</em></li>
</ol></li>
</ul></li>
</ul>
</div>
<div id="two-means-t-test" class="section level2">
<h2>Two Means T-test :</h2>
<ul>
<li><strong>Description:</strong> this tests if a mean from one group is different from the mean of another group for a normally distributed variable. AKA, testing to see if the difference in means is different from zero.</li>
</ul>
<table>
<thead>
<tr class="header">
<th>Numeric Var(s)</th>
<th>Cat. Var(s)</th>
<th>Cat. Var Group #</th>
<th>Cat. Var # of interest</th>
<th>Parametric</th>
<th>Paired</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>Yes</td>
<td>No</td>
</tr>
</tbody>
</table>
<ul>
<li><p><strong>Effect size calculation:</strong> <span class="math inline">\(Effect\:Size(D)= \frac{{|Mean_{H_1}-Mean_{H_0}}|}{SD_{pooled}}\)</span></p></li>
<li><p><strong><a href="Example:(1)" class="uri">Example:(1)</a></strong> <strong>: Is the average body temperature higher in women than in men?</strong></p></li>
<li><p><strong>Solution:</strong></p>
<ul>
<li><p>Here, <span class="math inline">\(H_0\:: Avg\:difference\:Body\:temp.\:between\:men\:and\: women=0°F\)</span> and <span class="math inline">\(H_1\:: Avg\:difference\:Body\:temp.\:between\:men\:and\: women&gt;0°F\)</span></p></li>
<li><p>We will guess that the <strong>effect sizes will be medium.</strong></p></li>
<li><p>For t-tests: <strong>0.2=small</strong>, <strong>0.5=medium</strong>, and <strong>0.8=large</strong> effect sizes.</p></li>
<li><p>Selected greater, because we only cared to test if women’s temp was higher, not lower (group 1 is women, group 2 is men)</p></li>
<li><p><strong>R Package:</strong> <em>pwr</em> Package</p></li>
<li><p><strong>R function:</strong> <em>pwr.t.test(d = , sig.level = , power = , type = c(“<strong>two.sample</strong>”, “one.sample”, “paired”))</em></p>
<ul>
<li>d= effect size</li>
<li>sig.level= significant level</li>
<li>power= power of test</li>
<li>type= type of test</li>
</ul></li>
<li><p><strong>Answer of the problem:</strong></p>
<pre class="r"><code>print(paste0(&quot;The Sample Size is :&quot;,round(pwr.t.test(d=0.5, sig.level=0.05, power=0.80,type=&quot;two.sample&quot;, alternative=&quot;greater&quot;)$n,0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is :50&quot;</code></pre></li>
</ul></li>
<li><p><strong><a href="Example:(2)" class="uri">Example:(2)</a></strong> <strong>Calculate the sample size for the following scenarios (with α=0.05, and power=0.80):</strong></p>
<ul>
<li><p><strong>(i)</strong> You are interested in determining if the average daily caloric intake different between men and women. You collected trial data and found the average caloric intake for males to be 2350.2 (SD=258), while females had intake of 1872.4 (SD=420).</p></li>
<li><p><strong>(ii)</strong> You are interested in determining if the average protein level in blood different between men and women. You collected the following trial data on protein level (grams/deciliter).</p>
<table>
<thead>
<tr class="header">
<th align="center">Protein</th>
<th align="center">levels</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Male Protein</td>
<td align="center">1.8, 5.8, 7.1, 4.6, 5.5, 2.4, 8.3, 1.2</td>
</tr>
<tr class="even">
<td align="center">Female Protein</td>
<td align="center">9.5, 2.6, 3.7, 4.7, 6.4, 8.4, 3.1, 1.4</td>
</tr>
</tbody>
</table></li>
<li><p><strong>(iii)</strong> You are interested in determining if the average glucose level in blood is lower in men than women.</p></li>
</ul></li>
<li><p><strong>Solution:</strong></p>
<ul>
<li><ol style="list-style-type: lower-roman">
<li>You are interested in determining if the average income of college freshman is less than Rs.20,000. You collect trial data and find that the mean income was Rs.14,500 (SD=6000).</li>
</ol>
<ul>
<li><p>Effect size = <span class="math inline">\((Mean_{H1}-Mean_{H0})/ SD_{pooled} =(2350.2-1872.4)/ \sqrt{(2582+ 4202)/2} =477.8/348.54 = 1.37\)</span></p></li>
<li><p>two-tailed test</p></li>
<li><p><strong>R Code:</strong></p></li>
</ul>
<pre class="r"><code>  print(paste0(&quot;The Sample Size is :&quot;,round(pwr.t.test(d=1.37, sig.level=0.05, power=0.80, type=&quot;two.sample&quot;,alternative=&quot;two.sided&quot;)$n,0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is :9&quot;</code></pre></li>
<li><ol start="2" style="list-style-type: lower-roman">
<li>Effect size =<span class="math inline">\((Mean_{H_1}-Mean_{H_0})/ SD_{pooled} =(4.59-4.98)/ \sqrt{(2.58^2+ 2.88^2)/2} = -0.14\)</span></li>
</ol>
<ul>
<li><p>Two-tailed test</p></li>
<li><p><strong>R Code:</strong></p></li>
</ul>
<pre class="r"><code>print(paste(&quot;The Sample Size is :&quot;,round(pwr.t.test(d=-0.14, sig.level=0.05, power=0.80, type=&quot;two.sample&quot;, alternative=&quot;two.sided&quot;)$n,0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is : 802&quot;</code></pre></li>
<li><ol start="3" style="list-style-type: lower-roman">
<li><em>Try it by yourself.</em></li>
</ol></li>
</ul></li>
</ul>
</div>
<div id="paired-t-test" class="section level2">
<h2>Paired T-test :</h2>
<ul>
<li><strong>Description:</strong> : This tests if a mean from one group is different from the mean of another group, where the groups are dependent (not independent) for a normally distributed variable. Pairing can be leaves on same branch, siblings, the same individual before and after a trial, etc.</li>
</ul>
<table>
<thead>
<tr class="header">
<th>Numeric Var(s)</th>
<th>Cat. Var(s)</th>
<th>Cat. Var Group #</th>
<th>Cat. Var # of interest</th>
<th>Parametric</th>
<th>Paired</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>Yes</td>
<td>Yes</td>
</tr>
</tbody>
</table>
<ul>
<li><p><strong>Effect size calculation:</strong> <span class="math inline">\(Effect\:Size(D)= \frac{{|Mean_{H_1}-Mean_{H_0}}|}{SD_{pooled}}\)</span></p></li>
<li><p><strong><a href="Example:(1)" class="uri">Example:(1)</a></strong> <strong>Is heart rate higher in patients after a run compared to before a run?</strong></p></li>
<li><p><strong>Solution:</strong></p>
<ul>
<li><p>Here, <span class="math inline">\(H_0\::bpm(after) – bpm(before) \leq 0\)</span> and <span class="math inline">\(H_1\:: bpm(after) – bpm(before)&gt;0\)</span></p></li>
<li><p>We will guess that the <strong>effect sizes will be large.</strong></p></li>
<li><p>For t-tests: <strong>0.2=small</strong>, <strong>0.5=medium</strong>, and <strong>0.8=large</strong> effect sizes.</p></li>
<li><p>Selected One-tailed, because we only cared if bpm was higher after a run.</p></li>
<li><p><strong>R Package:</strong> <em>pwr</em> Package</p></li>
<li><p><strong>R function:</strong> <em>pwr.t.test(d = , sig.level = , power = , type = c(“two.sample”, “one.sample”, “<strong>paired</strong>”))</em></p>
<ul>
<li>d= effect size</li>
<li>sig.level= significant level</li>
<li>power= power of test</li>
<li>type= type of test</li>
</ul></li>
<li><p><strong>Answer of the problem:</strong></p>
<pre class="r"><code>print(paste0(&quot;The Sample Size is :&quot;,round(pwr.t.test(d=0.8, sig.level=0.05, power=0.80, type=&quot;paired&quot;, alternative=&quot;greater&quot;)$n,0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is :11&quot;</code></pre></li>
</ul></li>
<li><p><strong><a href="Example:(2)" class="uri">Example:(2)</a></strong> <strong>Calculate the sample size for the following scenarios (with α=0.05, and power=0.80):</strong></p>
<ul>
<li><p><strong>(i)</strong> You are interested in determining if metabolic rate in patients after surgery is different from before surgery. You collected trial data and found a mean difference of 0.73 (SD=2.9).</p></li>
<li><p><strong>(ii)</strong> You are interested in determining if heart rate is higher in patients after a doctor’s visit compared to before a visit. You collected the following trial data and found mean heart rate before and after a visit.</p>
<table>
<thead>
<tr class="header">
<th align="center">Heart rate</th>
<th align="center">levels</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">BPM before</td>
<td align="center">126, 88, 53.1, 98.5, 88.3, 82.5, 105, 41.9</td>
</tr>
<tr class="even">
<td align="center">BPM after</td>
<td align="center">138.6, 110.1, 58.44, 110.2, 89.61, 98.6, 115.3, 64.3</td>
</tr>
</tbody>
</table></li>
</ul></li>
<li><p><strong>Solution:</strong></p>
<ul>
<li><ol style="list-style-type: lower-roman">
<li>You are interested in determining if metabolic rate in patients after surgery is different from before surgery. You collected trial data and found a mean difference of 0.73 (SD=2.9).</li>
</ol>
<ul>
<li><p>Effect size = <span class="math inline">\((Mean_{H_1}-Mean_{H_0})/SD =(0.73)/ 2.9 = 0.25\)</span></p></li>
<li><p>Two-tailed test</p></li>
<li><p><strong>R Code:</strong></p></li>
</ul>
<pre class="r"><code>  print(paste0(&quot;The Sample Size is :&quot;,round(pwr.t.test(d=0.25, sig.level=0.05, power=0.80, type=&quot;paired&quot;, alternative=&quot;two.sided&quot;)$n,0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is :128&quot;</code></pre></li>
<li><ol start="2" style="list-style-type: lower-roman">
<li>Effect size = <span class="math inline">\((Mean_{H_1}-Mean_{H_0})/ SD_{pooled} =(98.1-85.4)/ \sqrt{(26.82+ 27.22)/2} =12.7/27 = 0.47\)</span></li>
</ol>
<ul>
<li><p>One-tailed test</p></li>
<li><p><strong>R Code:</strong></p></li>
</ul>
<pre class="r"><code>print(paste(&quot;The Sample Size is :&quot;,round(pwr.t.test(d=0.47, sig.level=0.05, power=0.80, type=&quot;paired&quot;, alternative=&quot;greater&quot;)$n,0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is : 29&quot;</code></pre></li>
</ul></li>
</ul>
</div>
<div id="one-way-anova" class="section level2">
<h2>One-Way ANOVA :</h2>
<ul>
<li><strong>Description:</strong> : This tests if at least one mean is different among groups, where the groups are larger than two, for a normally distributed variable. ANOVA is the extension of the Two Means T-test for more than two groups.</li>
</ul>
<table>
<thead>
<tr class="header">
<th>Numeric Var(s)</th>
<th>Cat. Var(s)</th>
<th>Cat. Var Group #</th>
<th>Cat. Var # of interest</th>
<th>Parametric</th>
<th>Paired</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>&gt; 2</td>
<td>1</td>
<td>Yes</td>
<td>No</td>
</tr>
</tbody>
</table>
<ul>
<li><p><strong>Effect size calculation:</strong> <span class="math display">\[Effect\:Size(f)=\sqrt{\frac{\eta^2}{1-\eta^2}}\]</span> Where, <span class="math display">\[\eta = \frac{SS_T}{TSS}=\frac{Treatment\:Sum\:Squares}{Total\:Sum\:Squares}\]</span></p></li>
<li><p><strong><a href="Example:(1)" class="uri">Example:(1)</a></strong> <strong>Is there a difference in new car interest rates across 6 different cities?</strong></p></li>
<li><p><strong>Solution:</strong></p>
<ul>
<li><p>Here, <span class="math inline">\(H_0\::0\)</span> and <span class="math inline">\(H_1\:: \neq 0\)</span></p></li>
<li><p>There are a total of 6 groups (cities).</p></li>
<li><p>We will guess that the <strong>effect sizes will be small.</strong></p></li>
<li><p>For t-tests: <strong>0.2=small</strong>, <strong>0.5=medium</strong>, and <strong>0.8=large</strong> effect sizes.</p></li>
<li><p>Groups assumed to be the same size.</p></li>
<li><p><strong>R Package:</strong> <em>pwr</em> Package</p></li>
<li><p><strong>R function:</strong> <em>pwr.anova.test(k =, f = , sig.level = , power = )</em></p>
<ul>
<li>k= number of groups</li>
<li>f= effect size</li>
<li>sig.level= significant level</li>
<li>power= power of test</li>
</ul></li>
<li><p><strong>Answer of the problem:</strong></p>
<pre class="r"><code>print(paste0(&quot;The Sample Size is :&quot;,round(pwr.anova.test(k =6 , f =0.1 , sig.level=0.05 , power =0.80 )$n,0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is :215&quot;</code></pre></li>
</ul></li>
<li><p><strong><a href="Example:(2)" class="uri">Example:(2)</a></strong> <strong>Calculate the sample size for the following scenarios (with α=0.05, and power=0.80):</strong></p>
<ul>
<li><p><strong>(i)</strong> You are interested in determining there is a difference in weight lost between 4 different surgery options. You collect the following trial data of weight lost in pounds.</p>
<table>
<thead>
<tr class="header">
<th align="center">Surgery</th>
<th align="center">Weight Measures</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">A</td>
<td align="center">6.3, 2.8, 7.8, 7.9, 4.9</td>
</tr>
<tr class="even">
<td align="center">B</td>
<td align="center">9.9, 4.1, 3.9, 6.3, 6.9</td>
</tr>
<tr class="odd">
<td align="center">C</td>
<td align="center">5.1, 2.9, 3.6, 5.7, 4.5</td>
</tr>
<tr class="even">
<td align="center">D</td>
<td align="center">1.0, 2.8, 4.8, 3.9, 1.6</td>
</tr>
</tbody>
</table></li>
<li><p><strong>(ii)</strong> You are interested in determining if there is a difference in white blood cell counts between 5 different medication regimes.</p></li>
</ul></li>
<li><p><strong>Solution:</strong></p>
<ul>
<li><ol style="list-style-type: lower-roman">
<li>Here,</li>
</ol>
<ul>
<li><p><span class="math inline">\(\eta = SS_T/TSS=31.47/(31.47+62.87) = 0.33\)</span>
Note that, you can calculate <span class="math inline">\(SS_T\)</span> &amp; <span class="math inline">\(TSS\)</span> by performing ANOVA on the dataset using <em>aov()</em> function.</p></li>
<li><p>Effect size<span class="math inline">\((f)\)</span> = <span class="math inline">\(\sqrt{\eta^2/(1-\eta^2)}=\sqrt{0.33/(1- 0.33)} = 0.7\)</span></p></li>
<li><p>No. of groups= 4</p></li>
<li><p><strong>R Code:</strong></p></li>
</ul>
<pre class="r"><code>  print(paste0(&quot;The Sample Size is :&quot;,round(pwr.anova.test(k =4, f =0.7, sig.level=0.05, power =0.80 )$n,0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is :7&quot;</code></pre></li>
<li><ol start="2" style="list-style-type: lower-roman">
<li>You are interested in determining if there is a difference in white blood cell counts between 5 different medication regimes.</li>
</ol>
<ul>
<li><p>Guessed a medium effect size (0.25)</p></li>
<li><p>No. of groups= 5</p></li>
<li><p><strong>R Code:</strong></p></li>
</ul>
<pre class="r"><code>print(paste(&quot;The Sample Size is :&quot;,round(pwr.anova.test(k =5, f =0.25, sig.level=0.05, power =0.80 )$n,0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is : 39&quot;</code></pre></li>
</ul></li>
</ul>
</div>
<div id="single-proportion-test" class="section level2">
<h2>Single Proportion Test :</h2>
<ul>
<li><strong>Description:</strong> : This tests when you only have a single proportion and you want to know if the proportions of certain values differ from some constant proportion.</li>
</ul>
<table>
<thead>
<tr class="header">
<th>Numeric Var(s)</th>
<th>Cat. Var(s)</th>
<th>Cat. Var Group #</th>
<th>Cat. Var # of interest</th>
<th>Parametric</th>
<th>Paired</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>N/A</td>
<td>No</td>
</tr>
</tbody>
</table>
<ul>
<li><p><strong>Effect size calculation:</strong> <span class="math display">\[Effect\:Size(h)=2*(arcsin(\sqrt{p_{H_1}}))-2*(arcsin(\sqrt{p_{H_0}})))\]</span></p></li>
<li><p><strong><a href="Example:(1)" class="uri">Example:(1)</a></strong> <strong>Is there a significance difference in cancer prevalence of middle-aged women who have a sister with breast cancer (5%) compared to the general population prevalence (2%)?</strong></p></li>
<li><p><strong>Solution:</strong></p>
<ul>
<li><p>Here, <span class="math inline">\(H_0\::0\)</span> and <span class="math inline">\(H_1\:: \neq 0\)</span></p></li>
<li><p>You don’t have background info, so you guess that there is a small effect size.</p></li>
<li><p>For h-tests: <strong>0.2=small</strong>, <strong>0.5=medium</strong>, and <strong>0.8=large</strong> effect sizes.</p></li>
<li><p>Selected Two-sided, because we don’t care about directionality.</p></li>
<li><p><strong>R Package:</strong> <em>pwr</em> Package</p></li>
<li><p><strong>R function:</strong> <em>pwr.p.test(h = , sig.level =, power =, alternative=“two.sided”, “less”, or “greater” )</em></p>
<ul>
<li>h= effect size</li>
<li>sig.level= significant level</li>
<li>power= power of test</li>
<li>alternative= type of tail</li>
</ul></li>
<li><p><strong>Answer of the problem:</strong></p>
<pre class="r"><code>print(paste0(&quot;The Sample Size is :&quot;,round( pwr.p.test(h=0.2, sig.level=0.05, power=0.80, alternative=&quot;two.sided&quot;)$n,0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is :196&quot;</code></pre></li>
</ul></li>
<li><p><strong><a href="Example:(2)" class="uri">Example:(2)</a></strong> <strong>Calculate the sample size for the following scenarios (with α=0.05, and power=0.80):</strong></p>
<ul>
<li><p><strong>(i)</strong> You are interested in determining if the male incidence rate proportion of cancer in North Dakota is higher than the US average (prop=0.00490). You find trial data cancer prevalence of 0.00495.</p></li>
<li><p><strong>(ii)</strong> You are interested in determining if the female incidence rate proportion of cancer in North Dakota is lower than the US average (prop=0.00420).</p></li>
</ul></li>
<li><p><strong>Solution:</strong></p>
<ul>
<li><ol style="list-style-type: lower-roman">
<li>Here,</li>
</ol>
<ul>
<li><p>Effect size = <span class="math inline">\(2*arcsin(\sqrt{0.00495})-2*arcsin(\sqrt{0.00490})=0.0007\)</span>. Note that, in R arcsin can be calculated by the function <em>asin()</em>. Difference of proportion power calculation for binomial distribution (arcsine transformation)</p></li>
<li><p>One-sided test</p></li>
<li><p><strong>R Code:</strong></p></li>
</ul>
<pre class="r"><code>  print(paste0(&quot;The Sample Size is :&quot;,round(pwr.p.test(h=0.0007, sig.level=0.05, power=0.80, alternative=&quot;greater&quot;)$n,0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is :12617464&quot;</code></pre></li>
<li><ol start="2" style="list-style-type: lower-roman">
<li>You are interested in determining if the female incidence rate proportion of cancer in North Dakota is lower than the US average (prop=0.00420).</li>
</ol>
<ul>
<li><p>Guess a very low effect size (0.001)</p>
<ul>
<li><p>One-tailed test</p></li>
<li><p><strong>R Code:</strong></p></li>
</ul>
<pre class="r"><code>print(paste(&quot;The Sample Size is :&quot;,round(pwr.p.test(h=-0.001, sig.level=0.05, power=0.80, alternative=&quot;less&quot;)$n,0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is : 6182557&quot;</code></pre></li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="two-proportions-test" class="section level2">
<h2>Two Proportions Test :</h2>
<ul>
<li><strong>Description:</strong> : this tests when you only have two groups and you want to know if the proportions of each group are different from one another.</li>
</ul>
<table>
<thead>
<tr class="header">
<th>Numeric Var(s)</th>
<th>Cat. Var(s)</th>
<th>Cat. Var Group #</th>
<th>Cat. Var # of interest</th>
<th>Parametric</th>
<th>Paired</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>N/A</td>
<td>No</td>
</tr>
</tbody>
</table>
<ul>
<li><p><strong>Effect size calculation:</strong> <span class="math display">\[Effect\:Size(h)=2*(arcsin(\sqrt{p_{H_1}}))-2*(arcsin(\sqrt{p_{H_0}})))\]</span></p></li>
<li><p><strong><a href="Example:(1)" class="uri">Example:(1)</a></strong> <strong>Is the expected proportion of students passing a stats course taught by psychology teachers different from the observed proportion of students passing the same stats class taught by mathematics teachers?</strong></p></li>
<li><p><strong>Solution:</strong></p>
<ul>
<li><p>Here, <span class="math inline">\(H_0\::0\)</span> and <span class="math inline">\(H_1\:: \neq 0\)</span></p></li>
<li><p>You don’t have background info, so you guess that there is a small effect size.</p></li>
<li><p>For h-tests: <strong>0.2=small</strong>, <strong>0.5=medium</strong>, and <strong>0.8=large</strong> effect sizes.</p></li>
<li><p>Selected Two-sided, because we don’t care about directionality.</p></li>
<li><p><strong>R Package:</strong> <em>pwr</em> Package</p></li>
<li><p><strong>R function:</strong> <em>pwr.2p.test(h = , sig.level =, power =, alternative=“two.sided”, “less”, or “greater” )</em></p>
<ul>
<li>h= effect size</li>
<li>sig.level= significant level</li>
<li>power= power of test</li>
<li>alternative= type of tail</li>
</ul></li>
<li><p><strong>Answer of the problem:</strong></p>
<pre class="r"><code>print(paste0(&quot;The Sample Size is :&quot;,round( pwr.2p.test(h=0.2, sig.level=0.05, power=.80, alternative=&quot;two.sided&quot;)$n,0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is :392&quot;</code></pre></li>
</ul></li>
<li><p><strong><a href="Example:(2)" class="uri">Example:(2)</a></strong> <strong>Calculate the sample size for the following scenarios (with α=0.05, and power=0.80):</strong></p>
<ul>
<li><p><strong>(i)</strong> You are interested in determining if the expected proportion (P1) of students passing a stats course taught by psychology teachers is different than the observed proportion (P2) of students passing the same stats class taught by biology teachers. You collected the following data of passed tests.</p>
<table>
<thead>
<tr class="header">
<th>Teaching Method</th>
<th align="center">Response</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Psychology</td>
<td align="center">Yes, Yes, Yes, No, No, Yes, Yes, Yes, Yes, No</td>
</tr>
<tr class="even">
<td>Biology</td>
<td align="center">No, No, Yes, Yes, Yes, No, Yes, No, Yes, Yes</td>
</tr>
</tbody>
</table></li>
<li><p><strong>(ii)</strong> You are interested in determining of the expected proportion (P1) of female students who selected YES on a question was higher than the observed proportion (P2) of male students who selected YES. The observed proportion of males who selected yes was 0.75.</p></li>
</ul></li>
<li><p><strong>Solution:</strong></p>
<ul>
<li><ol style="list-style-type: lower-roman">
<li>Here,</li>
</ol>
<ul>
<li><p><span class="math inline">\(p_1=7/10=0.70, p_2=6/10=0.60\)</span>
Note that, you can calculate <span class="math inline">\(SS_T\)</span> &amp; <span class="math inline">\(TSS\)</span> by performing ANOVA on the dataset using <em>aov()</em> function.</p></li>
<li><p>Effect size= <span class="math inline">\(h= 2*asin(\sqrt{0.60})-2*asin(\sqrt{0.70})=-0.21\)</span></p></li>
<li><p><strong>R Code:</strong></p></li>
</ul>
<pre class="r"><code>  print(paste0(&quot;The Sample Size is :&quot;,round(pwr.2p.test(h=-0.21, sig.level=0.05, power=0.80, alternative=&quot;two.sided&quot;)$n,0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is :356&quot;</code></pre></li>
<li><ol start="2" style="list-style-type: lower-roman">
<li>You are interested in determining if there is a difference in white blood cell counts between 5 different medication regimes.</li>
</ol>
<ul>
<li><p>Guess that the expected proportion <span class="math inline">\((p_1)\)</span> =0.85</p></li>
<li><p>Effect Size= <span class="math inline">\(h= 2*asin(\sqrt{0.85})-2*asin(\sqrt{0.75})=0.25\)</span></p></li>
<li><p><strong>R Code:</strong></p></li>
</ul>
<pre class="r"><code>print(paste(&quot;The Sample Size is :&quot;,round(pwr.2p.test(h=0.25, sig.level=0.05, power=0.80, alternative=&quot;greater&quot;)$n,0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is : 198&quot;</code></pre></li>
</ul></li>
</ul>
</div>
<div id="chi-squared-test" class="section level2">
<h2>Chi-Squared Test :</h2>
<ul>
<li><strong>Description:</strong> : this tests when you only have two groups and you want to know if the proportions of each group are different from one another.</li>
</ul>
<table>
<thead>
<tr class="header">
<th>Numeric Var(s)</th>
<th>Cat. Var(s)</th>
<th>Cat. Var Group #</th>
<th>Cat. Var # of interest</th>
<th>Parametric</th>
<th>Paired</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(0\)</span></td>
<td><span class="math inline">\(\geq 1\)</span></td>
<td><span class="math inline">\(\geq 2\)</span></td>
<td>1</td>
<td>N/A</td>
<td>No</td>
</tr>
</tbody>
</table>
<ul>
<li><p><strong>Effect size calculation:</strong> <span class="math display">\[Effect\:Size(w)=\sqrt{\frac{{\chi}^2}{n\times df}}\]</span> where, <span class="math display">\[{\chi}^2=\sum{\frac{(O_i-E_i)^2}{E_i}}\]</span></p></li>
<li><p><strong><a href="Example:(1)" class="uri">Example:(1)</a></strong> <strong>Does the observed proportions of phenotypes from a genetics experiment different from the expected 9:3:3:1? </strong></p></li>
<li><p><strong>Solution:</strong></p>
<ul>
<li><p>Here, <span class="math inline">\(H_0\::0\)</span> and <span class="math inline">\(H_1\:: \neq 0\)</span></p></li>
<li><p>You don’t have background info, so you guess that there is a small effect size.</p></li>
<li><p>For w-tests: <strong>0.1=small</strong>, <strong>0.3=medium</strong>, and <strong>0.5=large</strong> effect sizes.</p></li>
<li><p>Degrees of freedoms= (the number of proportions minus 1) = 4 (phenotypes) – 1 = 3</p></li>
<li><p><strong>R Package:</strong> <em>pwr</em> Package</p></li>
<li><p><strong>R function:</strong> <em>pwr.chisq.test(w =, df = , sig.level =, power = )</em></p>
<ul>
<li>w= effect size</li>
<li>df= degrees of freedom</li>
<li>sig.level= significant level</li>
<li>power= power of test</li>
</ul></li>
<li><p><strong>Answer of the problem:</strong></p>
<pre class="r"><code>print(paste0(&quot;The Sample Size is :&quot;,round(pwr.chisq.test(w=0.3, df=3, sig.level=0.05, power=0.80)$N,0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is :121&quot;</code></pre></li>
</ul></li>
<li><p><strong><a href="Example:(2)" class="uri">Example:(2)</a></strong> <strong>Calculate the sample size for the following scenarios (with α=0.05, and power=0.80):</strong></p>
<ul>
<li><p><strong>(i)</strong> You are interested in determining if the ethnic ratios in a company differ by gender. You collect the following trial data from 200 employees.</p>
<table>
<thead>
<tr class="header">
<th align="left">Gender</th>
<th align="right">White</th>
<th align="right">Black</th>
<th align="center">Am.Indian</th>
<th align="center">Asian</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Male</td>
<td align="right">0.60</td>
<td align="right">0.25</td>
<td align="center">0.01</td>
<td align="center">0.14</td>
</tr>
<tr class="even">
<td align="left">Female</td>
<td align="right">0.65</td>
<td align="right">0.21</td>
<td align="center">0.11</td>
<td align="center">0.03</td>
</tr>
</tbody>
</table></li>
<li><p><strong>(ii)</strong> You are interested in determining if the proportions of student by year (Freshman, Sophomore, Junior, Senior) is any different from 1:1:1:1. You collect the following trial data.</p>
<hr />
<p>Student 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20
Grade Frs, Frs, Frs, Frs, Frs, Frs, Frs, Soph, Soph, Soph, Soph, Soph, Jun, Jun, Jun, Jun, Jun, Sen, Sen, Sen</p></li>
</ul></li>
<li><p><strong>Solution:</strong></p>
<ul>
<li><ol style="list-style-type: lower-roman">
<li>Note that,</li>
</ol>
<ul>
<li><p>If they were equal the expected ratios should be the same as the overall ethnic ratios (62.5, 23.0, 6.0, 8.5)</p></li>
<li><p>Will just focus on males</p></li>
<li><p><span class="math inline">\(\chi^2= \sum{\frac{(O_i-E_i)^2}{E_i}} = (60-62.5)2/62.5 + (25-23)2/23 + (1-6)2/6 + (14-8.5)2/8.5 = 8\)</span></p></li>
<li><p>Effect size= <span class="math inline">\(w = \sqrt{\chi^2 /(n*df)}= \sqrt{8/(200*3)}=0.115\)</span></p></li>
<li><p><strong>R Code:</strong></p></li>
</ul>
<pre class="r"><code>  print(paste0(&quot;The Sample Size is :&quot;,round(pwr.chisq.test(w=0.115, df=3, sig.level=0.05, power=0.80)$N,0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is :824&quot;</code></pre></li>
<li><ol start="2" style="list-style-type: lower-roman">
<li>Note that here,</li>
</ol>
<ul>
<li><p><span class="math inline">\(\chi^2= \sum{\frac{(O_i-E_i)^2}{E_i}} = (7-5)^2/5 + (5-5)^2/5 + (5-5)^2/5 + (3-5)^2/5 = 1.6\)</span></p></li>
<li><p>Effect Size= <span class="math inline">\(w = \sqrt{\chi^2 /(n*df)}= \sqrt{1.6/(20*3)}=0.163\)</span></p></li>
<li><p><strong>R Code:</strong></p></li>
</ul>
<pre class="r"><code>print(paste(&quot;The Sample Size is :&quot;,round(pwr.chisq.test(w=0.163, df=3, sig.level=0.05, power=0.80)$N,0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is : 410&quot;</code></pre></li>
</ul></li>
</ul>
</div>
<div id="simple-multiple-linear-regression" class="section level2">
<h2>Simple &amp; Multiple Linear Regression :</h2>
<ul>
<li><strong>Description:</strong> : this test determines if there is a significant relationship between two or more normally distributed numerical variables. The predictor variable is used to try to predict the response variable.</li>
</ul>
<table>
<thead>
<tr class="header">
<th>Numeric Var(s)</th>
<th>Cat. Var(s)</th>
<th>Cat. Var Group #</th>
<th>Cat. Var # of interest</th>
<th>Parametric</th>
<th>Paired</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2 or &gt;2</td>
<td>0</td>
<td>NA</td>
<td>NA</td>
<td>Yes</td>
<td>No</td>
</tr>
</tbody>
</table>
<ul>
<li><p><strong>Effect size calculation:</strong> <span class="math display">\[Effect\:Size(f2)=\sqrt{R^2}\]</span> Where, <span class="math display">\[R^2= Goodness\:of \:fit\:measure(i.e., Adjusted\:R^2)\]</span></p></li>
<li><p><strong><a href="Example:(1)" class="uri">Example:(1)</a></strong> <strong>Is there a relationship between height and weight in college males?</strong></p></li>
<li><p><strong>Solution:</strong></p>
<ul>
<li><p>Here, <span class="math inline">\(H_0\::0\)</span> and <span class="math inline">\(H_1\:: \neq 0\)</span></p></li>
<li><p>You don’t have background info, so you guess that there is a small effect size.</p></li>
<li><p>For <span class="math inline">\(f2\)</span>-tests: <strong>0.2=small</strong>, <strong>0.5=medium</strong>, and <strong>0.8=large</strong> effect sizes.</p></li>
<li><p>For simple regression (only one predictor variable) = numerator df=1 &amp; for multiple regression it is just the number of predictor variables.</p></li>
<li><p>Output will be denominator degrees of freedom rather than sample size; will need to round up and add 2 for simple linear regression &amp; add p+1; (where p= No. of predictor+1, because there is only one dependent outcome variable) for multiple linear regression to get sample size.</p></li>
<li><p><strong>R Package:</strong> <em>pwr</em> Package</p></li>
<li><p><strong>R function:</strong> <em>pwr.f2.test(u =, v= , f2=, sig.level =, power = )</em></p>
<ul>
<li>u= numerator degrees of freedom</li>
<li>v= denominator degrees of freedom</li>
<li>f2= effect size</li>
<li>sig.level= significant level</li>
<li>power= power of test</li>
</ul></li>
<li><p>To calculate sample size: Sample Size(n)= <strong>(denominator degrees of freedom(v) + Total No. of variables)</strong></p></li>
<li><p><strong>Answer of the problem:</strong></p>
<pre class="r"><code>print(paste0(&quot;The Sample Size is :&quot;,round( pwr.f2.test(u=1, f2=0.35, sig.level=0.05, power=0.80)$v,0)+2)) ##--2 has add because it is a simple linear regression</code></pre>
<pre><code>## [1] &quot;The Sample Size is :25&quot;</code></pre></li>
</ul></li>
<li><p><strong>Example: (2)</strong> <strong>You are interested in determining if height (meters), weight (grams), and fertilizer added (grams) in plants can predict yield (grams of berries). You collect the following trial data. Here <span class="math inline">\(\alpha=0.05\)</span>, &amp; <span class="math inline">\(Power=(1-\beta)=80%\)</span></strong></p>
<table>
<thead>
<tr class="header">
<th align="left">Variables</th>
<th align="center">Values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Yield</td>
<td align="center">46.8, 48.7, 48.4, 53.7, 56.7</td>
</tr>
<tr class="even">
<td align="left">Height</td>
<td align="center">14.6, 19.6, 18.6, 25.5, 20.4</td>
</tr>
<tr class="odd">
<td align="left">Weight</td>
<td align="center">95.3, 99.5, 94.1, 110, 103</td>
</tr>
<tr class="even">
<td align="left">Fertilizer</td>
<td align="center">2.1, 3.2, 4.3, 1.1, 4.3</td>
</tr>
</tbody>
</table></li>
<li><p><strong>Solution:</strong></p>
<ul>
<li><p>Here, at first we have to find the <span class="math inline">\(Adjusted\:R^2\)</span> value by fitting the linear model.</p></li>
<li><p>Then, we will find the sample size.</p></li>
<li><p><strong>R Code :</strong></p></li>
</ul>
<pre class="r"><code>#--Data--#
yield= c(46.8, 48.7, 48.4, 53.7, 56.7)
height= c(14.6, 19.6, 18.6, 25.5, 20.4)
weight= c(95.3, 99.5, 94.1, 110, 103)
Fert= c(2.1, 3.2, 4.3, 1.1, 4.3)

#-- Fitting Linear Model --#
Model= lm(height~yield + weight + Fert)

#-- Extracting Adjusted R^2 Value --#
R_Sqared= summary(Model)$adj.r.squared

#-- Calculating Effect (f2) --#
f.2= sqrt(R_Sqared)

#--  Calculating sample size --#
##--4 has added because it is a multiple linear Regression with 3 predictors and one dependent variable--##

print(paste0(&quot;The Sample Size is :&quot;,round( pwr.f2.test(u=1, f2=f.2, sig.level=0.05, power=0.80)$v,0)+4))</code></pre>
<pre><code>## [1] &quot;The Sample Size is :14&quot;</code></pre></li>
</ul>
</div>
<div id="correlation" class="section level2">
<h2>Correlation :</h2>
<ul>
<li><strong>Description:</strong> : This test determines if there is a difference between two numerical values. It is like simple regression, but is not identical.</li>
</ul>
<table>
<thead>
<tr class="header">
<th>Numeric Var(s)</th>
<th>Cat. Var(s)</th>
<th>Cat. Var Group #</th>
<th>Cat. Var # of interest</th>
<th>Parametric</th>
<th>Paired</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>0</td>
<td>NA</td>
<td>NA</td>
<td>Yes</td>
<td>No</td>
</tr>
</tbody>
</table>
<ul>
<li><p><strong>Effect size calculation:</strong> Effect Size= r= Correlation Coefficient</p></li>
<li><p><strong><a href="Example:(1)" class="uri">Example:(1)</a></strong> <strong>Is there a correlation between hours studied and test score? </strong></p></li>
<li><p><strong>Solution:</strong></p>
<ul>
<li><p>Here, <span class="math inline">\(H_0\::r=0\)</span> and <span class="math inline">\(H_1\:: r\neq 0\)</span></p></li>
<li><p>You don’t have background info, so you guess that there is a small effect size.</p></li>
<li><p>For Correlation levels (r): <strong>0.1=small</strong>, <strong>0.3=medium</strong>, and <strong>0.5=large</strong> correlations.</p></li>
<li><p>Here approximate correlation power calculation is done by arctangh transformation</p></li>
<li><p><strong>R Package:</strong> <em>pwr</em> Package</p></li>
<li><p><strong>R function:</strong> <em>pwr.r.test(r = , sig.level = , power = )</em></p>
<ul>
<li>r= correlation</li>
<li>sig.level= significant level</li>
<li>power= power of test</li>
</ul></li>
<li><p><strong>Answer of the problem:</strong></p>
<pre class="r"><code>print(paste0(&quot;The Sample Size is :&quot;,round(pwr.r.test(r=0.5, sig.level=0.05, power=0.80)$n,0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is :28&quot;</code></pre></li>
</ul></li>
<li><p><strong><a href="Example:(2)" class="uri">Example:(2)</a></strong> <strong>Calculate the sample size for the following scenarios (with α=0.05, and power=0.80):</strong></p>
<ul>
<li><p><strong>(i)</strong> You are interested in determining if there is a correlation between height and weight in men.</p>
<table>
<thead>
<tr class="header">
<th align="center">Males</th>
<th align="center">Measures</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Height</td>
<td align="center">178, 166, 172, 186, 182</td>
</tr>
<tr class="even">
<td align="center">Weight</td>
<td align="center">165, 139, 257, 225, 196</td>
</tr>
</tbody>
</table></li>
<li><p><strong>(ii)</strong> You are interested in determining if, in lab mice, the correlation between longevity (in months) and average protein intake (grams).</p></li>
</ul></li>
<li><p><strong>Solution:</strong></p>
<ul>
<li><ol style="list-style-type: lower-roman">
<li>Here,</li>
</ol>
<ul>
<li><p>first, calculate the correlation value, and then calculate the sample size.</p></li>
<li><p><strong>R Code:</strong></p></li>
</ul>
<pre class="r"><code>#-- Data --#
MH= c(178,166,172,186,182)
MW= c(165,139,257,225,196)

#-- correlation value --#

r= cor(MH,MW)
print(paste0(&quot;The Sample Size is :&quot;,round(pwr.r.test(r=0.37, sig.level=0.05, power=0.80)$n,0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is :54&quot;</code></pre></li>
<li><p>(ii)You are interested in determining if, in lab mice, the correlation between longevity (in months) and average protein intake (grams).</p>
<ul>
<li><p>Guessed large (0.5) correlation</p></li>
<li><p><strong>R Code:</strong></p></li>
</ul>
<pre class="r"><code>print(paste(&quot;The Sample Size is :&quot;,round(pwr.r.test(r=0.5, sig.level=0.05, power=0.80)$n,0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is : 28&quot;</code></pre></li>
</ul></li>
</ul>
</div>
<div id="non-parametric-t-tests" class="section level2">
<h2>Non-Parametric T-tests :</h2>
<ul>
<li><strong>Description:</strong> versions of the t-tests for non-parametric data.
<ul>
<li><em><span class="math inline">\(\color{red}{\text{One Mean Wilcoxon:}}\)</span></em> sample mean against set value</li>
<li><em><span class="math inline">\(\color{red}{\text{Mann-Whitney:}}\)</span></em> two sample means (unpaired)</li>
<li><em><span class="math inline">\(\color{red}{\text{Paired Wilcoxon:}}\)</span></em> two sample means (paired)</li>
</ul></li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">Name</th>
<th>Numeric Var(s)</th>
<th>Cat. Var(s)</th>
<th>Cat. Var Group #</th>
<th>Cat. Var # of interest</th>
<th>Parametric</th>
<th>Paired</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(\color{red}{\text{One Mean Wilcoxon:}}\)</span></td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>No</td>
<td>NA</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\color{red}{\text{Mann-Whitney:}}\)</span></td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>No</td>
<td>No</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\color{red}{\text{Paired Wilcoxon:}}\)</span></td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>No</td>
<td>Yes</td>
</tr>
</tbody>
</table>
<ul>
<li><p><strong>Effect size calculation:</strong> <span class="math inline">\(\text{Effect Size}\;(\text{Cohen’s D:})= \frac{{|{\mu}_{H_1}-{\mu}_{H_0}}|}{\sigma};\frac{{|{\mu}_{H_1}-{\mu}_{H_0}}|}{\sigma_{pooled}};\frac{{\mu}_{\text{diff}}}{\sigma_{\text{diff}}}\)</span></p></li>
<li><p><strong><a href="Example:(1)" class="uri">Example:(1)</a></strong> <strong>(for t-tests, 0.2=small, 0.5=medium, and 0.8 large effect sizes)</strong></p>
<ul>
<li><ol style="list-style-type: decimal">
<li><em><span class="math inline">\(\color{red}{\text{One Mean Wilcoxon:}}\)</span></em> <strong>Is the average number of children in Grand Forks families different than 1?</strong></li>
</ol></li>
<li><strong>Solution:</strong>
<ul>
<li><p>Here, <span class="math inline">\(H_0\:: 1\;\text{child}\)</span> and <span class="math inline">\(H_1\:: &gt;1\;\text{child}\)</span></p></li>
<li><p>You don’t have background info, so you guess that there is a <strong>medium effect size.</strong></p></li>
<li><p>Select one-tailed (greater)</p></li>
<li><p><strong>R Package:</strong> <em>pwr</em> Package</p></li>
<li><p><strong>R function:</strong> <em>pwr.t.test(d = , sig.level = , power = , type = c(“two.sample”, “<strong>one.sample</strong>”, “paired”)) + 15%</em></p>
<ul>
<li>d= effect size</li>
<li>sig.level= significant level</li>
<li>power= power of test</li>
<li>type= type of test</li>
</ul></li>
<li><p><strong>Answer of the problem:</strong></p></li>
</ul>
<pre class="r"><code>Pwer_t=pwr.t.test(d=0.5, sig.level=0.05, power=0.80, type=&quot;one.sample&quot;, alternative=&quot;greater&quot;)

##-- Nonparametric Correction : adding 15% --##
print(paste0(&quot;Sample Size : &quot;,round((Pwer_t$n*1.15),0)))</code></pre>
<pre><code>## [1] &quot;Sample Size : 30&quot;</code></pre></li>
<li><ol start="2" style="list-style-type: decimal">
<li><em><span class="math inline">\(\color{red}{\text{Mann-Whitney:}}\)</span></em> <strong>Does the average number of snacks per day for individuals on a diet differ between young and old persons?</strong></li>
</ol></li>
<li><strong>Solution:</strong>
<ul>
<li><p>Here, <span class="math inline">\(H_0\:: 0\;\text{difference in snack number, }\)</span> and <span class="math inline">\(H_1\:: \neq 0\;\text{difference in snack number}\)</span></p></li>
<li><p>You don’t have background info, so you guess that there is a <strong>small effect size</strong></p></li>
<li><p>Select two-sided</p></li>
<li><p><strong>R Package:</strong> <em>pwr</em> Package</p></li>
<li><p><strong>R function:</strong> <em>pwr.t.test(d = , sig.level = , power = , type = c(“<strong>two.sample</strong>”, “one.sample”, “paired”)) + 15%</em></p>
<ul>
<li>d= effect size</li>
<li>sig.level= significant level</li>
<li>power= power of test</li>
<li>type= type of test</li>
</ul></li>
<li><p>Note: <a href="https://www.graphpad.com/guides/prism/7/statistics/stat_sample_size_for_nonparametric_.htm"><strong>“Parametric t-test + 15% Approach”</strong> for calculating Sample Size for Non Parametric test</a></p></li>
<li><p><strong>Answer of the problem:</strong></p></li>
</ul>
<pre class="r"><code>Pwer_t=pwr.t.test(d=0.2, sig.level=0.05, power=0.80, type=&quot;two.sample&quot;, alternative=&quot;two.sided&quot;)

##-- Nonparametric Correction : adding 15% --##
print(paste0(&quot;Sample Size : &quot;,round((Pwer_t$n*1.15),0)))</code></pre>
<pre><code>## [1] &quot;Sample Size : 452&quot;</code></pre></li>
<li><ol start="3" style="list-style-type: decimal">
<li><em><span class="math inline">\(\color{red}{\text{Paired Wilcoxon:}}\)</span></em> <strong>Is genome methylation patterns different between identical twins?</strong></li>
</ol></li>
<li><strong>Solution:</strong>
<ul>
<li><p>Here, <span class="math inline">\(H_0\::\text{0% methylation}\)</span> and <span class="math inline">\(H_1\:: \neq \text{0% methylation}\)</span></p></li>
<li><p>You don’t have background info, so you guess that there is a <strong>large effect size</strong></p></li>
<li><p>Select one-tailed (greater)</p></li>
<li><p><strong>R Package:</strong> <em>pwr</em> Package</p></li>
<li><p><strong>R function:</strong> <em>pwr.t.test(d = , sig.level = , power = , type = c(“two.sample”, “one.sample”, <strong>“paired”</strong>)) + 15%</em></p>
<ul>
<li>d= effect size</li>
<li>sig.level= significant level</li>
<li>power= power of test</li>
<li>type= type of test</li>
</ul></li>
<li><p><strong>Answer of the problem:</strong></p></li>
</ul>
<pre class="r"><code>Pwer_t= pwr.t.test(d=0.8, sig.level=0.05, power=0.80, type=&quot;paired&quot;, alternative=&quot;greater&quot;)

##-- Nonparametric Correction : adding 15% --##
print(paste0(&quot;Sample Size : &quot;,round((Pwer_t$n*1.15),0)))</code></pre>
<pre><code>## [1] &quot;Sample Size : 13&quot;</code></pre></li>
</ul></li>
<li><p><strong><a href="Example:(2)" class="uri">Example:(2)</a></strong> <strong>Calculate the sample size for the following scenarios (with <span class="math inline">\(\alpha=0.05\)</span>, and power=0.80):</strong></p>
<ul>
<li><p><strong>(i)</strong> You are interested in determining if the average number of pets in Grand Forks families is greater than 1. You collect the following trial data for pet number.</p>
<table>
<thead>
<tr class="header">
<th align="center">Variable</th>
<th align="center">Values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Pets</td>
<td align="center">1, 1, 1, 3, 2, 1, 0, 0, 0, 4</td>
</tr>
</tbody>
</table></li>
<li><p><strong>(ii)</strong> You are interested in determining if the number of meals per day for individuals on a diet is higher in younger people than older. You collected trial data on meals per day.</p>
<table>
<thead>
<tr class="header">
<th align="center">Variable</th>
<th align="center">Values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Young meals</td>
<td align="center">1, 2, 2, 3, 3, 3, 3, 4</td>
</tr>
<tr class="even">
<td align="center">Older meals</td>
<td align="center">1, 1, 1, 2, 2, 2, 3, 3</td>
</tr>
</tbody>
</table></li>
<li><p><strong>(iii)</strong> You are interested in determining if genome methylation patterns are higher in the first fraternal twin born compared to the second. You collected the following trial data on methylation level difference (in percentage).</p>
<table>
<thead>
<tr class="header">
<th align="center">Variable</th>
<th align="center">Values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Methy.Diff(%)</td>
<td align="center">5.96, 5.63, 1.25, 1.17, 3.59, 1.64, 1.6, 1.4</td>
</tr>
</tbody>
</table></li>
</ul></li>
<li><p><strong>Solution:</strong></p>
<ul>
<li><ol style="list-style-type: lower-roman">
<li>You are interested in determining if the average income of college freshman is less than Rs.20,000. You collect trial data and find that the mean income was Rs.14,500 (SD=6000).</li>
</ol>
<ul>
<li><p>Effect size = <span class="math inline">\((Mean_{H_1}-Mean_{H_0})/SD= (1.3-1.0)/1.34 =0.224\)</span></p></li>
<li><p>One-tailed test</p></li>
<li><p><strong>R Code:</strong></p></li>
</ul>
<pre class="r"><code>Pwer_t= pwr.t.test(d=0.224, sig.level=0.05, power=0.80, type=&quot;one.sample&quot;, alternative=&quot;greater&quot;)

#-- Non-parametric Correction --# 
print(paste0(&quot;The Sample Size is :&quot;,round(Pwer_t$n*1.15,0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is :143&quot;</code></pre></li>
<li><ol start="2" style="list-style-type: lower-roman">
<li><em>Try it by yourself.</em></li>
</ol></li>
<li><ol start="3" style="list-style-type: lower-roman">
<li><em>Try it by yourself.</em></li>
</ol></li>
</ul></li>
</ul>
</div>
<div id="kruskal-wallace-test" class="section level2">
<h2>Kruskal Wallace Test :</h2>
<ul>
<li><p><strong>Description:</strong> : this tests if at least one mean is different among groups, where the groups are larger than two for a non-normally distributed variable. (AKA, non-parametric ANOVA). There really isn’t a good way of calculating sample size in R, but you can use a rule of thumb:</p>
<ul>
<li>Run Parametric Test</li>
<li>Add 15% to total sample size</li>
</ul></li>
</ul>
<table>
<thead>
<tr class="header">
<th>Numeric Var(s)</th>
<th>Cat. Var(s)</th>
<th>Cat. Var Group #</th>
<th>Cat. Var # of interest</th>
<th>Parametric</th>
<th>Paired</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>&gt;2</td>
<td>1</td>
<td>No</td>
<td>No</td>
</tr>
</tbody>
</table>
<ul>
<li><p><strong>Effect size calculation:</strong> Effect Size = Same as the effect size for the ANOVA.</p></li>
<li><p><strong><a href="Example:(1)" class="uri">Example:(1)</a></strong> ** Is there a difference in draft rank across 3 different months? **</p></li>
<li><p><strong>Solution:</strong></p>
<ul>
<li><p>Here, <span class="math inline">\(H_0\::r=0\)</span> and <span class="math inline">\(H_1\:: r\neq 0\)</span></p></li>
<li><p>There will be a total of 3 groups (months)</p></li>
<li><p>You don’t have background info, so you guess that there is a <strong>medium effect size.</strong></p></li>
<li><p>For <span class="math inline">\(\text{f-test}\)</span> : <strong>0.1=small</strong>, <strong>0.25=medium</strong>, and <strong>0.4=large</strong> correlations.</p></li>
<li><p>No Tails in ANOVA</p></li>
<li><p>Groups assumed to be the same size.</p></li>
<li><p><strong>R Package:</strong> <em>pwr</em> Package</p></li>
<li><p><strong>R function:</strong> <em>pwr.anova.test(k =, f = , sig.level = , power = )</em></p>
<ul>
<li>k= number of groups</li>
<li>f= effect size</li>
<li>sig.level= significant level</li>
<li>power= power of test</li>
</ul></li>
<li><p><strong>Answer of the problem:</strong></p></li>
</ul>
<pre class="r"><code>  ##-- Balanced one-way analysis of variance power calculation --##
  Pwr_Anova=  pwr.anova.test(k =3 , f =0.25 , sig.level=0.05 , power =0.80 )

  #-- Non-parametric Correction --#
  print(paste0(&quot;The Sample Size is :&quot;,round((Pwr_Anova$n*1.15),0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is :60&quot;</code></pre></li>
<li><p><strong><a href="Example:(2)" class="uri">Example:(2)</a></strong> <strong>Calculate the sample size for the following scenarios (with α=0.05, and power=0.80):</strong></p>
<ul>
<li><p><strong>(i)</strong> You are interested in determining there is a difference in hours worked across 3 different groups(faculty, staff, and hourly workers). You collect the following trial data of weekly hours.</p>
<table>
<thead>
<tr class="header">
<th align="center">Groups</th>
<th align="center">Working Hours</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Faculty</td>
<td align="center">42, 45, 46, 55, 42</td>
</tr>
<tr class="even">
<td align="center">Staff</td>
<td align="center">46, 45, 37, 42, 40</td>
</tr>
<tr class="odd">
<td align="center">Hourly</td>
<td align="center">29, 42, 33, 50, 23</td>
</tr>
</tbody>
</table></li>
<li><p><strong>(ii)</strong> You are interested in determining there is a difference in assistant professor salaries across 25 different departments.</p></li>
</ul></li>
<li><p><strong>Solution:</strong></p>
<ul>
<li><ol style="list-style-type: lower-roman">
<li>Here,</li>
</ol>
<ul>
<li><p><span class="math inline">\(\eta^2 = SS_T/TSS=286.5/(286.5+625.2) = 0.314\)</span>
Note that, you can calculate <span class="math inline">\(SS_T\)</span> &amp; <span class="math inline">\(TSS\)</span> by performing ANOVA on the dataset using <em>aov()</em> function.</p></li>
<li><p>Effect size<span class="math inline">\((f)\)</span> = <span class="math inline">\(\sqrt{\eta^2/(1-\eta^2)}=\sqrt{0.314/(1- 0.314)} = 0.677\)</span></p></li>
<li><p>No. of groups= 3</p></li>
<li><p><strong>R Code:</strong></p></li>
</ul>
<pre class="r"><code>  ##-- Balanced one-way analysis of variance power calculation --##
  Pwr_Anova=  pwr.anova.test(k =3, f =0.677, sig.level=0.05, power =0.80)

  #-- Non-parametric Correction --#
  print(paste0(&quot;The Sample Size is :&quot;,round((Pwr_Anova$n*1.15),0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is :9&quot;</code></pre></li>
<li><ol start="2" style="list-style-type: lower-roman">
<li>You are interested in determining there is a difference in assistant professor salaries across 25 different departments.</li>
</ol>
<ul>
<li><p>Guess small effect size (0.10)</p></li>
<li><p>No. of groups= 25</p></li>
<li><p><strong>R Code:</strong></p></li>
</ul>
<pre class="r"><code>  #-- Balanced one-way analysis of variance power calculation --#
  Pwr_Anova= pwr.anova.test(k =25, f =0.10, sig.level=0.05, power =0.80)

  #-- Non-parametric Correction --#
  print(paste0(&quot;The Sample Size is :&quot;,round((Pwr_Anova$n*1.15),0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is :104&quot;</code></pre></li>
</ul></li>
</ul>
</div>
<div id="repeated-measures-anova" class="section level2">
<h2>Repeated Measures ANOVA :</h2>
<ul>
<li><strong>Description:</strong> : this tests if at least one mean is different among groups, where the groups are repeated measures (more than two) for a normally distributed variable. Repeated Measures ANOVA is the extension of the Paired T-test for more than two groups.</li>
</ul>
<table>
<thead>
<tr class="header">
<th>Numeric Var(s)</th>
<th>Cat. Var(s)</th>
<th>Cat. Var Group #</th>
<th>Cat. Var # of interest</th>
<th>Parametric</th>
<th>Paired</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>&gt; 2</td>
<td>1</td>
<td>Yes</td>
<td>No</td>
</tr>
</tbody>
</table>
<ul>
<li><p><strong>Effect size calculation:</strong> <span class="math display">\[Effect\:Size(f)=\frac{\sigma_m}{\sigma}\]</span> Where, <span class="math display">\[\sigma_m=\sqrt{\frac{\sum_{j=1}^K{(m_j-m)^2}}{k}}= Standard\:Deviation\:of\:group\:means\]</span> <span class="math display">\[m_j= j^{th}\:group\:mean\:,\:\:\forall\:j=1(1)K\]</span> <span class="math display">\[m=Overall\:mean\]</span> <span class="math display">\[K=number\:of\:groups\]</span> <span class="math display">\[\sigma=overall\:standard\:deviation\]</span></p></li>
<li><p><strong><a href="Example:(1)" class="uri">Example:(1)</a></strong> <strong>Is there a difference in blood pressure at 1, 2, 3, and 4 months post-treatment?</strong></p></li>
<li><p><strong>Solution:</strong></p>
<ul>
<li><p>Here, <span class="math inline">\(H_0\::0\)</span> and <span class="math inline">\(H_1\:: \neq 0\)</span></p></li>
<li><p><strong>1 group</strong>, <strong>4 measurements</strong></p></li>
<li><p>We will guess that the <strong>effect sizes will be small.</strong></p></li>
<li><p>For t-tests: <strong>0.2=small</strong>, <strong>0.5=medium</strong>, and <strong>0.8=large</strong> effect sizes.</p></li>
<li><p>For the nonsphericity correction coefficient, 1 means sphericity is met. There are methods to estimate this but will go with 1 for this example.</p></li>
<li><p><strong>R Package:</strong> <em>WebPower</em> Package</p></li>
<li><p><strong>R function:</strong> <em>wp.rmanova(ng = NULL, nm = NULL, f = NULL, nscor = 1, alpha = 0.05, power = NULL, type = 0) </em></p>
<ul>
<li><p>ng= number of groups</p></li>
<li><p>nm= number of measurements</p></li>
<li><p>f= effect size</p></li>
<li><p>nscor= nonsphericity correction coefficient</p></li>
<li><p>alpha= significant level of test</p></li>
<li><p>power= statistical power</p></li>
<li><p>type= (0,1,2) The value “0” is for between-effect; “1” is for within-effect; and “2” is for interaction effect.</p></li>
<li><p><strong>Note:</strong></p>
<ul>
<li><strong>Within-effects:</strong> variability of a particular value for individuals in a sample</li>
<li><strong>Between-effects:</strong> examines differences between individuals</li>
</ul></li>
</ul></li>
<li><p><strong>Answer of the problem:</strong></p></li>
</ul>
<pre class="r"><code>library(WebPower)
print(paste0(&quot;The Sample Size is :&quot;,round(wp.rmanova(n=NULL, ng=1, nm=4, f=0.1, nscor=1, alpha=0.05, power=0.80, type=1)$n,0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is :1092&quot;</code></pre>
<ul>
<li><p>Note:</p></li>
<li><p><a href="https://webpower.psychstat.org/wiki/manual/power_of_rmanova#power_curve">Power analysis for within-effect test</a></p></li>
<li><p><a href="https://stattrek.com/anova/repeated-measures/sphericity.aspx">Sphericity and Repeated Measures ANOVA</a></p></li>
</ul></li>
<li><p><strong><a href="Example:(2)" class="uri">Example:(2)</a></strong> <strong>Calculate the sample size for the following scenarios (with α=0.05, and power=0.80):</strong></p>
<ul>
<li><p><strong>(i)</strong> You are interested in determining if there is a difference in blood serum levels at 6, 12, 18, and 24 months post-treatment. You collect the following trial data of blood serum in mg/dL.</p>
<table>
<thead>
<tr class="header">
<th align="center">Months</th>
<th align="center">Blood Serum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">6 Months</td>
<td align="center">38, 13, 32, 35, 21</td>
</tr>
<tr class="even">
<td align="center">12 Months</td>
<td align="center">38, 44, 35, 48, 27</td>
</tr>
<tr class="odd">
<td align="center">18 Months</td>
<td align="center">46, 15, 53, 51, 29</td>
</tr>
<tr class="even">
<td align="center">24 Months</td>
<td align="center">52, 29, 60, 44, 36</td>
</tr>
</tbody>
</table></li>
<li><p><strong>(ii)</strong> You are interested in determining if there is a difference in antibody levels at 1, 2, and 3 months post-treatment.</p></li>
</ul></li>
<li><p><strong>Solution:</strong></p>
<ul>
<li><ol style="list-style-type: lower-roman">
<li>Here,</li>
</ol>
<p>-Effect Size: <span class="math inline">\(f =\sqrt{\frac{(27.8−37.3)^2+(38.4−37.3)^2+(38.8−37.3)^2+(25.2−37.3)^2}{4}}/ 12.74 = 0.608\)</span></p>
<ul>
<li>To get sphericity, ran ANOVA</li>
</ul>
<pre class="r"><code>library(ez)</code></pre>
<pre><code>## Warning: package &#39;ez&#39; was built under R version 4.1.3</code></pre>
<pre><code>## Registered S3 methods overwritten by &#39;car&#39;:
##   method                          from
##   influence.merMod                lme4
##   cooks.distance.influence.merMod lme4
##   dfbeta.influence.merMod         lme4
##   dfbetas.influence.merMod        lme4</code></pre>
<pre class="r"><code>data=data.frame(Patient= factor(rep(c(1,2,3,4,5),4)),
                Month= factor(c(rep(&quot;6 Months&quot;,5),rep(&quot;12 Months&quot;,5),rep(&quot;18 Months&quot;,5),rep(&quot;24 Months&quot;,5))),
                Serum= c(38,13,32,35,21,38,44,35,48,27,46,15,53,51,29,52,29,60,44,36))
anova3= ezANOVA(data, dv=Serum, wid=Patient, within=.(Month),detailed=TRUE)
anova3</code></pre>
<pre><code>## $ANOVA
##        Effect DFn DFd     SSn    SSd         F           p p&lt;.05       ges
## 1 (Intercept)   1   4 27825.8 1506.7 73.872171 0.001006882     * 0.9212804
## 2       Month   3  12   706.6  870.9  3.245378 0.060146886       0.2291032
## 
## $`Mauchly&#39;s Test for Sphericity`
##   Effect         W         p p&lt;.05
## 2  Month 0.1556327 0.4348287      
## 
## $`Sphericity Corrections`
##   Effect       GGe     p[GG] p[GG]&lt;.05       HFe      p[HF] p[HF]&lt;.05
## 2  Month 0.4844127 0.1187469           0.6892662 0.09014564</code></pre>
<ul>
<li><p>Note: <a href="https://people.umass.edu/bwdillon/LING609/Lectures/Section3/Lecture21.html">For more details about <em>ezANOVA() function</em> for Sphericity and Repeated Measures ANOVA</a></p></li>
<li><p>Sphericity was non-significant (0.43), so coefficient of 1</p></li>
<li><p>One group, four measurements, within-effects so type 1</p></li>
<li><p><strong>R Code:</strong></p></li>
</ul>
<pre class="r"><code>  print(paste0(&quot;The Sample Size is :&quot;,round(wp.rmanova(n=NULL, ng=1, nm=4, f=0.608, nscor=1, alpha=0.05, power=0.80, type=1)$n,0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is :31&quot;</code></pre></li>
<li><ol start="2" style="list-style-type: lower-roman">
<li>You are interested in determining if there is a difference in antibody levels at 1, 2, and 3 months post-treatment.</li>
</ol>
<ul>
<li><p>Guess a nonsphericity correction of of 1 and medium effect 0.25</p></li>
<li><p>One group, three measurements, type 1</p></li>
<li><p><strong>R Code:</strong></p></li>
</ul>
<pre class="r"><code>  print(paste(&quot;The Sample Size is :&quot;,round(wp.rmanova(n=NULL, ng=1, nm=3, f=0.25, nscor=1, alpha=0.05, power=0.80, type=1)$n,0)))</code></pre>
<pre><code>## [1] &quot;The Sample Size is : 156&quot;</code></pre></li>
</ul></li>
</ul>
</div>
